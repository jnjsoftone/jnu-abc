#!/usr/bin/env node
var e;let o,i;import{Octokit as r}from"@octokit/rest";import a from"yargs";import{findAllRepos as t,findGithubAccount as s,createRemoteRepo as p,setLocalConfig as n,cloneRepo as c,initLocalRepo as m,deleteRemoteRepo as l,initRepo as d,copyRepo as N,pushRepo as R,makeRepo as g,removeRepo as b}from"./git.js";import{getCurrentDir as u}from"./cli.js";let v=a.usage("Usage: -e <exec> -u <userName> -n <repoName> -d <description> -p <isPrivate>").option("e",{alias:"exec",default:"copyRepo",describe:"exec command copyRepo(clone+local config)/makeRepo(create remote+push)/removeRepo(delete remote+local)",type:"string",demandOption:!0}).option("u",{alias:"userName",default:"mooninlearn",describe:"Name of User",type:"string"}).option("n",{alias:"repoName",describe:"NameOfRepository",type:"string"}).option("p",{alias:"isPrivate",default:!1,describe:"Private Repository",type:"boolean"}).option("d",{alias:"description",describe:"Description For Repository",type:"string"}).argv,y=s(v.userName??"");y.userName=v.userName??"",console.log(`#### git account: ${JSON.stringify(y)}`);let k=new r({auth:y.token}),f=(e=v.repoName??"",(i=u()).split("/").pop()!==e&&(i+=`/${e}`),i??"");switch(v.exec){case"listRepos":(async()=>{try{o=await t(k),console.log(JSON.stringify(o,null,2))}catch(e){console.error("저장소 목록 조회 중 오류 발생:",e)}})();break;case"createRemoteRepo":console.log(`createRemoteRepo: ${v}`),p(k,{name:v.repoName??"",description:v.description??"",isPrivate:v.isPrivate??!1});break;case"deleteRemoteRepo":l(k,{name:v.repoName??""},y);break;case"setLocalConfig":n({name:v.repoName??"",description:v.description??""},y,f);break;case"cloneRepo":c({name:v.repoName??"",description:v.description??""},y,f);break;case"initLocalRepo":m({name:v.repoName??"",description:v.description??""},y,f);break;case"initRepo":console.log("====initRepo"),d(k,{name:v.repoName??"",description:v.description??"",isPrivate:v.isPrivate??!1},y,f);break;case"pushRepo":R({name:v.repoName??"",description:v.description??""},y,f);break;case"copyRepo":N({name:v.repoName??"",description:v.description??"description",isPrivate:v.isPrivate??!1},y,f);break;case"makeRepo":g(k,{name:v.repoName??"",description:v.description??"",isPrivate:v.isPrivate??!1},y,f);break;case"removeRepo":b(k,{name:v.repoName??""},y,f)}